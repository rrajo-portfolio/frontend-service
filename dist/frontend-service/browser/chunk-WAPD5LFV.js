import{a as W}from"./chunk-4EOHQ6L3.js";import{a as K}from"./chunk-B4X2TKTK.js";import{b as X,c as et}from"./chunk-XO7O2M7B.js";import{a as J}from"./chunk-XBRHJR42.js";import{c as Q}from"./chunk-2666AO3O.js";import"./chunk-EMWOT3NJ.js";import{a as ct}from"./chunk-437U45AM.js";import"./chunk-HBN5ZDUM.js";import{$ as O,$a as Z,A as z,B as y,Ba as U,Bc as at,Ca as q,Cc as ot,D as M,Da as L,E as S,N as e,O as u,Pb as tt,Q as _,R as N,S as g,Tb as it,Ua as G,V as a,W as r,Wa as H,X as C,Y as P,Z as w,_ as E,_a as Y,aa as d,bb as B,ea as F,fa as o,g as j,ga as m,ha as x,mc as nt,oa as c,pa as s,qa as b,ra as R,sa as $,v as k,xa as A,y as v,ya as V,za as D,zc as rt}from"./chunk-PRE4TB56.js";function st(n,i){if(n&1){let t=E();a(0,"mat-card",14)(1,"div",15)(2,"div")(3,"p",16),o(4),c(5,"slice"),r(),a(6,"h3"),o(7),r()(),a(8,"button",17),c(9,"translate"),O("click",function(){let l=M(t).$implicit,f=d(3);return S(f.remove(l.productId))}),C(10,"lucide-icon",18),r()(),a(11,"div",19)(12,"div",20)(13,"span"),o(14),c(15,"translate"),r(),a(16,"strong"),o(17),c(18,"currency"),r()(),a(19,"mat-form-field",21)(20,"mat-label"),o(21),c(22,"translate"),r(),a(23,"input",22),O("input",function(l){let f=M(t).$implicit,T=d(3);return S(T.updateQuantity(f.productId,l.target.value))}),r()(),a(24,"div",23)(25,"span"),o(26),c(27,"translate"),r(),a(28,"strong"),o(29),c(30,"currency"),r()()()()}if(n&2){let t=i.$implicit;e(4),x("#",R(5,9,t.productId,0,8),""),e(3),m(t.productName),e(),N("aria-label",s(9,13,"cart.remove")),e(6),m(s(15,15,"order.detail.price")),e(3),m(b(18,17,t.price,t.currency)),e(4),m(s(22,20,"cart.quantity")),e(2),g("value",t.quantity),e(3),m(s(27,22,"cart.lineTotal")),e(3),m(b(30,24,t.price*t.quantity,t.currency))}}function lt(n,i){if(n&1&&(a(0,"small"),o(1),c(2,"translate"),a(3,"strong"),o(4),r(),o(5),r()),n&2){let t=d(3);e(),x(" ",s(2,3,"cart.associatedUser")," "),e(3),m(t.user.name),e(),x(" (",t.user.email,"). ")}}function dt(n,i){if(n&1){let t=E();P(0),a(1,"div",6),_(2,st,31,27,"mat-card",7),r(),a(3,"mat-card",8)(4,"div",9)(5,"div")(6,"p",10),o(7),c(8,"translate"),r(),a(9,"p",11),o(10),c(11,"currency"),r()(),a(12,"button",12),O("click",function(){M(t);let l=d().ngIf,f=d();return S(f.checkout(l))}),C(13,"lucide-icon",13),o(14),c(15,"translate"),r()(),_(16,lt,6,5,"small",4),r(),w()}if(n&2){let t=d().ngIf,p=d();e(2),g("ngForOf",t),e(5),m(s(8,6,"cart.total")),e(3),m(b(11,8,p.getTotal(t),p.getCurrency(t))),e(2),g("disabled",p.isSubmitting),e(2),x(" ",s(15,11,"cart.payment")," "),e(2),g("ngIf",p.user)}}function ut(n,i){if(n&1&&(P(0),_(1,dt,17,13,"ng-container",5),w()),n&2){let t=i.ngIf;d();let p=F(15);e(),g("ngIf",t.length)("ngIfElse",p)}}function gt(n,i){n&1&&(a(0,"div",24),C(1,"lucide-icon",25),a(2,"p"),o(3),c(4,"translate"),r(),a(5,"a",26),C(6,"lucide-icon",27),o(7),c(8,"translate"),r()()),n&2&&(e(3),m(s(4,2,"cart.empty")),e(4),x(" ",s(8,4,"cart.goToCatalog")," "))}var h=class n{constructor(i,t,p,l,f,T){this.cartService=i;this.ordersService=t;this.notificationService=p;this.authService=l;this.router=f;this.translationService=T}user;isSubmitting=!1;destroy$=new j;get items$(){return this.cartService.items$}ngOnInit(){this.authService.getCurrentUser().pipe(k(this.destroy$)).subscribe(i=>this.user=i)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}remove(i){this.cartService.remove(i)}updateQuantity(i,t){!Number.isFinite(t)||t<1||this.cartService.updateQuantity(i,Math.floor(t))}checkout(i){if(!i.length||this.isSubmitting)return;if(!this.user){this.notificationService.error(this.translationService.translate("cart.toast.missingUser"));return}let t=this.getCurrency(i),p={userId:this.user.id,currency:t,items:i.map(l=>({productId:l.productId,quantity:l.quantity}))};this.isSubmitting=!0,this.ordersService.createOrder(p).subscribe({next:l=>{this.notificationService.success(this.translationService.translate("cart.toast.success")),this.cartService.clear(),this.isSubmitting=!1,this.router.navigate(["/orders",l.id])},error:()=>{this.isSubmitting=!1,this.notificationService.error(this.translationService.translate("cart.toast.error"))}})}getTotal(i){return i.reduce((t,p)=>t+p.price*p.quantity,0)}getCurrency(i){return i[0]?.currency??"USD"}static \u0275fac=function(t){return new(t||n)(u(W),u(K),u(J),u(Q),u(Y),u(X))};static \u0275cmp=z({type:n,selectors:[["app-cart"]],decls:16,vars:12,consts:[["emptyCart",""],[1,"cart-container"],[1,"page-header"],[1,"eyebrow"],[4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"items-grid"],["class","cart-item",4,"ngFor","ngForOf"],[1,"summary-card"],[1,"summary-row"],[1,"summary-label"],[1,"summary-value"],["mat-raised-button","","color","primary","type","button",3,"click","disabled"],["name","CreditCard","size","18"],[1,"cart-item"],[1,"item-head"],[1,"sku"],["mat-icon-button","","type","button",3,"click"],["name","Trash2","size","18"],[1,"item-body"],[1,"price-box"],["appearance","outline",1,"quantity-field"],["matInput","","type","number","min","1",3,"input","value"],[1,"price-box","total"],[1,"empty-cart"],["name","ShoppingCart","size","48"],["routerLink","/catalog",1,"btn","btn-primary"],["name","ArrowRight","size","16"]],template:function(t,p){t&1&&(a(0,"section",1)(1,"div",2)(2,"div")(3,"p",3),o(4),c(5,"translate"),r(),a(6,"h2"),o(7),c(8,"translate"),r(),a(9,"p"),o(10),c(11,"translate"),r()()(),_(12,ut,2,2,"ng-container",4),c(13,"async"),_(14,gt,9,6,"ng-template",null,0,$),r()),t&2&&(e(4),m(s(5,4,"cart.eyebrow")),e(3),m(s(8,6,"cart.title")),e(3),m(s(11,8,"cart.description")),e(2),g("ngIf",s(13,10,p.items$)))},dependencies:[A,V,G,H,it,at,rt,ot,tt,Z,D,q,U,et],styles:[".cart-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px;padding:24px}.cart-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.cart-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .eyebrow[_ngcontent-%COMP%]{text-transform:uppercase;letter-spacing:.2em;font-size:.75rem;color:#6b7280;margin-bottom:4px}.cart-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:clamp(28px,4vw,36px)}.cart-container[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#4b5563;margin:4px 0 0}.items-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:16px}.cart-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.cart-item[_ngcontent-%COMP%]   .item-head[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.cart-item[_ngcontent-%COMP%]   .item-head[_ngcontent-%COMP%]   .sku[_ngcontent-%COMP%]{text-transform:uppercase;font-size:.75rem;letter-spacing:.1em;color:#9ca3af;margin:0 0 4px}.cart-item[_ngcontent-%COMP%]   .item-head[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.1rem}.cart-item[_ngcontent-%COMP%]   .item-body[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:flex-end;flex-wrap:wrap}.cart-item[_ngcontent-%COMP%]   .price-box[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.cart-item[_ngcontent-%COMP%]   .price-box[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.8rem;color:#6b7280}.cart-item[_ngcontent-%COMP%]   .price-box[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:1.2rem}.cart-item[_ngcontent-%COMP%]   .price-box.total[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#1d4ed8}.cart-item[_ngcontent-%COMP%]   .quantity-field[_ngcontent-%COMP%]{width:120px}.summary-card[_ngcontent-%COMP%]{padding:24px;display:flex;flex-direction:column;gap:8px}.summary-card[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:16px}.summary-card[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%]{margin:0;text-transform:uppercase;letter-spacing:.2em;font-size:.75rem;color:#6b7280}.summary-card[_ngcontent-%COMP%]   .summary-value[_ngcontent-%COMP%]{margin:0;font-size:2rem}.empty-cart[_ngcontent-%COMP%]{min-height:320px;padding:48px;border:1px dashed #d1d5db;border-radius:20px;display:flex;flex-direction:column;gap:16px;align-items:center;justify-content:center;color:#6b7280}.empty-cart[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:1.1rem}.empty-cart[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px}"]})};var ft=[{path:"",component:h}],I=class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=y({type:n});static \u0275inj=v({imports:[B.forChild(ft),B]})};var mt=class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=y({type:n});static \u0275inj=v({imports:[L,nt,ct,I]})};export{mt as CartModule};
