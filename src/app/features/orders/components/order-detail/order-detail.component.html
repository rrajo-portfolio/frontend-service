<ng-container *ngIf="order$ | async as order">
  <section class="order-detail">
    <mat-card class="summary-card">
      <mat-card-title>Pedido #{{ order.id | slice: 0 : 8 }}</mat-card-title>
      <mat-card-subtitle>
        Estado actual:
        <span class="status-chip" [ngClass]="order.status.toLowerCase()">
          {{ order.status }}
        </span>
      </mat-card-subtitle>
      <mat-card-content>
        <div class="summary-grid">
          <div>
            <p class="label">Cliente</p>
            <p class="value">{{ order.userName || 'Usuario' }}</p>
            <small>{{ order.userEmail || order.userId }}</small>
          </div>
          <div>
            <p class="label">Total</p>
            <p class="value">{{ order.totalAmount | currency: order.currency }}</p>
            <small>Emitido el {{ order.createdAt | date: 'medium' }}</small>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="items-card">
      <mat-card-title>Productos</mat-card-title>
      <mat-card-content>
        <mat-list>
          <mat-list-item *ngFor="let item of order.items">
            <div class="item-line">
              <div>
                <p class="item-name">{{ item.productName || item.productId }}</p>
                <small>ID {{ item.productId }}</small>
              </div>
              <div class="item-meta">
                <span>Cantidad: {{ item.quantity }}</span>
                <span>{{ item.price | currency: order.currency }}</span>
              </div>
            </div>
          </mat-list-item>
        </mat-list>
      </mat-card-content>
    </mat-card>
  </section>
</ng-container>
